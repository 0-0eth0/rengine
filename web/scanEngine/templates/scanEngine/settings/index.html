{% extends 'base/base.html' %}
{% load static %}
{% load custom_tags %}
{% block title %}
Settings & API Keys
{% endblock title %}

{% block custom_js_css_link %}
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/custom.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/components/tabs-accordian/custom-accordions.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/elements/alert.css' %}">
{% endblock custom_js_css_link %}

{% block breadcrumb_title %}
Settings
{% endblock breadcrumb_title %}

{% block main_content %}
<div class="statbox widget box box-shadow">
  <div class="widget-header">
    <div class="row">
      <div class="col-xl-12 col-md-12 col-sm-12 col-12">
        <h4>Tool Specific Settings</h4>
      </div>
    </div>
  </div>
  <div class="widget-content widget-content-area">
    <p>This section lets you enter tool specific settings like API keys, custom config etc.</p>
    <div id="toggleAccordion">
      <div class="card">
        <div class="card-header" id="gfHeading">
          <section class="mb-0 mt-0">
            <div role="menu" class="collapsed" data-toggle="collapse" data-target="#gfAccordion" aria-expanded="false" aria-controls="gfAccordion">
              GF Patterns  <div class="icons"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
            </div>
          </section>
        </div>

        <div id="gfAccordion" class="collapse" aria-labelledby="gfHeading" data-parent="#toggleAccordion">
          <div class="card-body">
            <p>
              This section lets you upload custom gf patterns. You can find more information about the <a href="https://github.com/tomnomnom/gf" class="text-info">GF Tool here.</a>
              Choose the GF pattern using the file uploader.
            </br>
            <span class="text-danger">Please note that only json files are supported and the name of the pattern will be the filename.
            </br>If the pattern name is <span class="badge badge-info">remote-code-exec.json</span>, the pattern name is <span class="badge badge-info">remote-code-exec</span> this is to be used this in YAML configuration.</span>
          </p>
          <p>
            <h6 class="text-muted">Currently available GF patterns</h6>

            {% for pattern in gf_patterns %}
            <span class="badge badge-pills outline-badge-info m-1">{{pattern}}</span>
            {% endfor %}
          </p>
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group mb-4 mt-3">
              <label for="gfFileUpload">Upload GF Pattern JSON</label>
              <input type="file" class="form-control-file" name="gfFileUpload" accept="application/JSON">
            </div>
            <input type="submit" class="btn btn-primary" value="Upload">
          </form>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="nucleiHeading">
        <section class="mb-0 mt-0">
          <div role="menu" class="collapsed" data-toggle="collapse" data-target="#nucleiAccordion" aria-expanded="false" aria-controls="nucleiAccordion">
            Nuclei  <div class="icons"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
          </div>
        </section>
      </div>

      <div id="nucleiAccordion" class="show" aria-labelledby="nucleiHeading" data-parent="#nucleiAccordion">
        <div class="card-body">
          <p>
            This section lets you upload Nuclei templates. You can find more information about the <a href="https://nuclei.projectdiscovery.io/" class="text-info">Nuclei Templates here.</a>
          </br>
          <span class="text-danger">Please note that only YAML files are supported and the name of the pattern will be the filename.
          </br>If the template name is <span class="badge badge-info">apache-detect.yaml</span> then the template name is <span class="badge badge-info">apache-detect</span> this is to be used this in YAML configuration.</span>
        </p>
        <p>
          <h6 class="text-muted">Currently available custom Nuclei templates</h6>
          {% for template in nuclei_templates %}
          {% with file=template|split:"/" %}
          <span class="badge badge-pills outline-badge-info m-1">{{file.3}}</span>
          {% endwith %}
          {% empty %}
          <div class="alert alert-light-warning border-0 mb-4" role="alert">
            <strong>No custom nuclei templates detected!</strong>
          </div>
          {% endfor %}
        </p>
        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="form-group mb-4 mt-3">
            <label for="nucleiFileUpload">Upload Nuclei Template YAML</label>
            <input type="file" class="form-control-file" name="nucleiFileUpload" accept=".yaml">
          </div>
          <input type="submit" class="btn btn-primary" value="Upload">
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock main_content %}


{% block page_level_script %}
<script src="{% static 'custom/custom.js' %}"></script>
{% endblock page_level_script %}
