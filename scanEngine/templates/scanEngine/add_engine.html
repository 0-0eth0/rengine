{% extends 'base/base.html' %}
{% load static %}

{% block title %}
Add Engine Type
{% endblock title %}


{% block custom_js_css_link %}
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/forms/switches.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/custom.css' %}">
{{ form.media }}
<style media="screen">
.ace_editor {
	width:100%;
	height:650px;
	font-size:12px;
	border:1px solid #CCC;
}
.django-ace-toolbar{
	display: none;
}
</style>
{% endblock custom_js_css_link %}

{% block breadcrumb_title %}
Add new engine
{% endblock breadcrumb_title %}

{% block main_content %}
<div class="col-lg-12 layout-spacing">
    <div class="statbox widget box box-shadow">
        <div class="widget-header">
            <div class="row">
                <div class="col-12">
                    <h4 class="text-info">Add Scan Engine Name</h4>
                    {{ form.errors }}
                    {{ form.non_field_errors }}
                </div>
            </div>
        </div>
        <div class="widget-content widget-content-area">
            <form class="simple-example" method="POST">
                {% csrf_token %}
                <div class="form-row layout-spacing">
                    <div class="col-12">
                        <label for="domainName" class="text-info">Engine name</label>
                        {{ form.scan_type_name }}
                    </div>
                </div>
                <div class="form-row layout-spacing">
                    <table>
                        <tr>
                            <td>
                                <h6 style="margin-right:1%">Subdomain Discovery</h6>
                                <span class="preview">(Selected by Default)</span>
                            </td>
                            <td>
                                <input type="hidden" name="subdomain_discovery" value="on">
                                <label class="switch s-icons s-outline s-outline-info">
                                    {{form.subdomain_discovery}}
                                    <span class="slider round"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <h6 style="margin-right:1%">Port Scan</h6>
                            </td>
                            <td>
                                <label class="switch s-icons s-outline s-outline-info">
                                    {{form.port_scan}}
                                    <span class="slider round"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <h6 style="margin-right:1%">Subdomain Takeover</h6>
                            </td>
                            <td>
                                <label class="switch s-icons s-outline s-outline-info">
                                    {{form.subdomain_takeover}}
                                    <span class="slider round"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <h6 style="margin-right:1%">Directory and Files Search</h6>
                            </td>
                            <td>
                                <label class="switch s-icons s-outline s-outline-info">
                                    {{form.dir_file_search}}
                                    <span class="slider round"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <h6 style="margin-right:1%">Fetch All URLs</h6>
                                <span class="preview">(Open Threat Exchange, Wayback Machine <br>Common Crawl)</span>
                            </td>
                            <td>
                                <label class="switch s-icons s-outline s-outline-info">
                                    {{form.fetch_url}}
                                    <span class="slider round"></span>
                                </label>
                            </td>
                        </tr>
                    </table>
                </div>
                <h4>Configurations</h4>
                <p>
                    reNgine supports YAML based configurations for customizing the scan. The default settings are given below, you may choose to proceed with the default settings or configure it according to your choice.
                    <br>
                    <span class="text-warning">Note: Invalid YAML configuration may crash your scan. Use with caution.</span>
                </p>
				<div class="col-12">
					{{form.yaml_configuration}}
				</div>
                <button class="btn btn-primary submit-fn mt-2 float-right" type="submit">Add Engine</button>
            </form>
        </div>
    </div>
</div>
{% endblock main_content %}


{% block page_level_script %}
<script src="{% static 'assets/js/scrollspyNav.js' %}"></script>
{% endblock page_level_script %}
