{% extends 'base/base.html' %}
{% load static %}

{% block title %}
Settings & API Keys
{% endblock title %}

{% block custom_js_css_link %}
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/custom.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/components/tabs-accordian/custom-accordions.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/elements/alert.css' %}">
{% endblock custom_js_css_link %}

{% block breadcrumb_title %}
Settings
{% endblock breadcrumb_title %}

{% block main_content %}
<div class="statbox widget box box-shadow">
  <div class="widget-header">
    <div class="row">
      <div class="col-xl-12 col-md-12 col-sm-12 col-12">
        <h4>Settings</h4>
      </div>
    </div>
  </div>
  <div class="widget-content widget-content-area">
    <p>This section lets you enter tool specific settings like API keys, custom config etc.</p>
    <div id="toggleAccordion">
      <div class="card">
        <div class="card-header" id="gfHeading">
          <section class="mb-0 mt-0">
            <div role="menu" class="" data-toggle="collapse" data-target="#gfAccordion" aria-expanded="false" aria-controls="gfAccordion">
              GF Patterns  <div class="icons"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
            </div>
          </section>
        </div>

        <div id="gfAccordion" class="collapse show" aria-labelledby="gfHeading" data-parent="#toggleAccordion">
          <div class="card-body">
            <p>
              This section lets you save custom gf patterns. You can find more information about the <a href="https://github.com/tomnomnom/gf" class="text-info">GF Tool here.</a>
              Choose the GF pattern using the file uploader.
            </br>
            <span class="text-danger">Please note that only json files are supported and the name of the pattern will be the filename. Suppose if the pattern name is remote-code-exec.json, the pattern name is remote-code-exec, use this in YAML configuration.</span>
          </p>
          <p>
            <h6 class="text-muted">Currently available GF patterns</h6>

            {% for pattern in gf_patterns %}
            <span class="badge badge-pills badge-info m-1">{{pattern}}</span>
            {% endfor %}
          </p>
          {% for message in messages %}
          <div class="alert alert-light-success border-0 mb-4" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            {{message}}
          </div>
          {% endfor %}
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group mb-4 mt-3">
              <label for="exampleFormControlFile1">Upload GF Pattern JSON</label>
              <input type="file" class="form-control-file" name="gfFileUpload" accept="application/JSON">
            </div>
            <input type="submit" class="btn btn-primary" value="Upload">
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock main_content %}


{% block page_level_script %}
<script src="{% static 'custom/custom.js' %}"></script>
{% endblock page_level_script %}
